<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" /><meta name="generator" content="Docutils 0.18.1: http://docutils.sourceforge.net/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>TimeSteppingSchemesOde &mdash; opendihu 1.4 documentation</title>
      <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  <!--[if lt IE 9]>
    <script src="../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script src="../_static/jquery.js?v=5d32c60e"></script>
        <script src="../_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
        <script src="../_static/documentation_options.js?v=0ed52906"></script>
        <script src="../_static/doctools.js?v=888ff710"></script>
        <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
        <script async="async" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script src="../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Operator Splitting" href="splitting.html" />
    <link rel="prev" title="FiniteElementMethod" href="finite_element_method.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="../index.html" class="icon icon-home">
            opendihu
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">User documentation</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../introduction.html">Introduction</a></li>
<li class="toctree-l1"><a class="reference internal" href="../user/existing_examples.html">Existing examples</a></li>
<li class="toctree-l1"><a class="reference internal" href="../user/validation.html">Validation</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../settings.html">Python Settings</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="mesh.html">Mesh</a></li>
<li class="toctree-l2"><a class="reference internal" href="mappings_between_meshes.html">MappingsBetweenMeshes</a></li>
<li class="toctree-l2"><a class="reference internal" href="solver.html">Solver</a></li>
<li class="toctree-l2"><a class="reference internal" href="boundary_conditions.html">Boundary Conditions</a></li>
<li class="toctree-l2"><a class="reference internal" href="output_connector_slots.html">Connector Slots</a></li>
<li class="toctree-l2"><a class="reference internal" href="finite_element_method.html">FiniteElementMethod</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">TimeSteppingSchemesOde</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#common-properties">Common properties</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#endtime-numbertimesteps-and-timestepwidth">endTime, numberTimeSteps and timeStepWidth</a></li>
<li class="toctree-l4"><a class="reference internal" href="#logtimestepwidthaskey-lognumbertimestepsaskey-and-durationlogkey">logTimeStepWidthAsKey, logNumberTimeStepsAsKey and durationLogKey</a></li>
<li class="toctree-l4"><a class="reference internal" href="#timestepoutputinterval">timeStepOutputInterval</a></li>
<li class="toctree-l4"><a class="reference internal" href="#initialvalues">initialValues</a></li>
<li class="toctree-l4"><a class="reference internal" href="#dirichletboundaryconditions-and-inputmeshisglobal">dirichletBoundaryConditions and inputMeshIsGlobal</a></li>
<li class="toctree-l4"><a class="reference internal" href="#outputwriter">OutputWriter</a></li>
<li class="toctree-l4"><a class="reference internal" href="#nadditionalfieldvariables">nAdditionalFieldVariables</a></li>
<li class="toctree-l4"><a class="reference internal" href="#additionalslotnames">additionalSlotNames</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#expliciteuler">ExplicitEuler</a></li>
<li class="toctree-l3"><a class="reference internal" href="#impliciteuler">ImplicitEuler</a></li>
<li class="toctree-l3"><a class="reference internal" href="#heun">Heun</a></li>
<li class="toctree-l3"><a class="reference internal" href="#heunadaptive">HeunAdaptive</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#tolerance">tolerance</a></li>
<li class="toctree-l4"><a class="reference internal" href="#mintimestepwidth">minTimeStepWidth</a></li>
<li class="toctree-l4"><a class="reference internal" href="#timestepadaptoption">timeStepAdaptOption</a></li>
<li class="toctree-l4"><a class="reference internal" href="#lowestmultiplier">lowestMultiplier</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#cranknicolson">CrankNicolson</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="splitting.html">Operator Splitting</a></li>
<li class="toctree-l2"><a class="reference internal" href="coupling.html">Coupling</a></li>
<li class="toctree-l2"><a class="reference internal" href="coupling.html#multiplecoupling">MultipleCoupling</a></li>
<li class="toctree-l2"><a class="reference internal" href="output_writer.html">OutputWriter</a></li>
<li class="toctree-l2"><a class="reference internal" href="output_surface.html">OutputSurface</a></li>
<li class="toctree-l2"><a class="reference internal" href="multidomain_solver.html">MultidomainSolver</a></li>
<li class="toctree-l2"><a class="reference internal" href="multiple_instances.html">MultipleInstances</a></li>
<li class="toctree-l2"><a class="reference internal" href="fast_monodomain_solver.html">FastMonodomainSolver</a></li>
<li class="toctree-l2"><a class="reference internal" href="cellml_adapter.html">CellMLAdapter</a></li>
<li class="toctree-l2"><a class="reference internal" href="quasi_static_linear_elasticity_solver.html">QuasiStaticLinearElasticitySolver</a></li>
<li class="toctree-l2"><a class="reference internal" href="static_bidomain_solver.html">StaticBidomainSolver</a></li>
<li class="toctree-l2"><a class="reference internal" href="hyperelasticity.html">Hyperelasticity</a></li>
<li class="toctree-l2"><a class="reference internal" href="dynamic_hyperelasticity.html">Dynamic hyperelasticity</a></li>
<li class="toctree-l2"><a class="reference internal" href="muscle_contraction_solver.html">Muscle contraction solver</a></li>
<li class="toctree-l2"><a class="reference internal" href="prescribed_values.html">PrescribedValues</a></li>
<li class="toctree-l2"><a class="reference internal" href="prescribed_values.html#dummy">Dummy</a></li>
<li class="toctree-l2"><a class="reference internal" href="map_dofs.html">MapDofs</a></li>
<li class="toctree-l2"><a class="reference internal" href="precice_adapter.html">PreciceAdapter</a></li>
</ul>
</li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Developer documentation</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../developer_information.html">Information for developers</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">opendihu</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../index.html" class="icon icon-home" aria-label="Home"></a></li>
          <li class="breadcrumb-item"><a href="../settings.html">Python Settings</a></li>
      <li class="breadcrumb-item active">TimeSteppingSchemesOde</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../_sources/settings/timestepping_schemes_ode.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="timesteppingschemesode">
<h1>TimeSteppingSchemesOde<a class="headerlink" href="#timesteppingschemesode" title="Link to this heading">ÔÉÅ</a></h1>
<p>Several timestepping schemes to solve ordinary differential equations are implemented. The C++ classes are listed in the following</p>
<p>C++ code:</p>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="n">TimeSteppingScheme</span><span class="o">::</span><span class="n">ExplicitEuler</span><span class="o">&lt;</span><span class="cm">/* inner object, DiscretizableInTime*/</span><span class="o">&gt;</span>
<span class="n">TimeSteppingScheme</span><span class="o">::</span><span class="n">ImplicitEuler</span><span class="o">&lt;</span><span class="cm">/* inner object, DiscretizableInTime*/</span><span class="o">&gt;</span>
<span class="n">TimeSteppingScheme</span><span class="o">::</span><span class="n">Heun</span><span class="o">&lt;</span><span class="cm">/* inner object, DiscretizableInTime*/</span><span class="o">&gt;</span>
<span class="n">TimeSteppingScheme</span><span class="o">::</span><span class="n">HeunAdaptive</span><span class="o">&lt;</span><span class="cm">/* inner object, DiscretizableInTime*/</span><span class="o">&gt;</span>
<span class="n">TimeSteppingScheme</span><span class="o">::</span><span class="n">CrankNicolson</span><span class="o">&lt;</span><span class="cm">/* inner object, DiscretizableInTime*/</span><span class="o">&gt;</span>
</pre></div>
</div>
<p>They all have the following properties in common.</p>
<p>The following example is a configuration of the ExplicitEuler scheme:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="s2">&quot;ExplicitEuler&quot;</span> <span class="p">:</span> <span class="p">{</span>
  <span class="s2">&quot;endTime&quot;</span><span class="p">:</span>                     <span class="mf">0.1</span><span class="p">,</span>
  <span class="s2">&quot;numberTimeSteps&quot;</span><span class="p">:</span>             <span class="mi">5</span><span class="p">,</span>
  <span class="s2">&quot;timeStepWidth&quot;</span><span class="p">:</span>               <span class="mf">1e-5</span><span class="p">,</span>
  <span class="s2">&quot;logTimeStepWidthAsKey&quot;</span><span class="p">:</span>       <span class="s2">&quot;dt_1D&quot;</span><span class="p">,</span>
  <span class="s2">&quot;durationLogKey&quot;</span><span class="p">:</span>              <span class="s2">&quot;duration_1D&quot;</span><span class="p">,</span>
  <span class="s2">&quot;timeStepOutputInterval&quot;</span><span class="p">:</span>      <span class="mf">1e4</span><span class="p">,</span>
  <span class="s2">&quot;initialValues&quot;</span><span class="p">:</span>               <span class="p">[],</span>
  <span class="s2">&quot;dirichletBoundaryConditions&quot;</span><span class="p">:</span> <span class="p">{</span><span class="mi">0</span><span class="p">:</span> <span class="o">-</span><span class="mf">75.0036</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">:</span> <span class="o">-</span><span class="mf">75.0036</span><span class="p">},</span>
  <span class="s2">&quot;inputMeshIsGlobal&quot;</span><span class="p">:</span>           <span class="kc">True</span><span class="p">,</span>
  <span class="s2">&quot;nAdditionalFieldVariables&quot;</span><span class="p">:</span>   <span class="mi">1</span><span class="p">,</span>
  <span class="s2">&quot;additionalSlotNames&quot;</span><span class="p">:</span>         <span class="p">[</span><span class="s2">&quot;a&quot;</span><span class="p">],</span>
  <span class="s2">&quot;OutputWriter&quot;</span><span class="p">:</span> <span class="o">...</span>
<span class="p">}</span>
</pre></div>
</div>
<section id="common-properties">
<h2>Common properties<a class="headerlink" href="#common-properties" title="Link to this heading">ÔÉÅ</a></h2>
<p>In the following, the properties that can be specified for all time stepping schemes to solve ODEs (Heun, Euler, CrankNicolson) are listed.</p>
<section id="endtime-numbertimesteps-and-timestepwidth">
<h3>endTime, numberTimeSteps and timeStepWidth<a class="headerlink" href="#endtime-numbertimesteps-and-timestepwidth" title="Link to this heading">ÔÉÅ</a></h3>
<p><em>The default values of the settings are: ``endTime``: 1, ``timestepWidth``: 0.001, ``numberTimeSteps``: 10.</em></p>
<p>Every timestepping scheme has a  <code class="docutils literal notranslate"><span class="pre">run()</span></code> method and a <code class="docutils literal notranslate"><span class="pre">advanceTimeSpan()</span></code> method.
The <code class="docutils literal notranslate"><span class="pre">run()</span></code> method is called from the C++ main source file, if the timestepping scheme is the outermost class of the composite class templates.
It performs the simulation for <span class="math notranslate nohighlight">\(t \in [0, \text{endTime}]\)</span>. The other method, <code class="docutils literal notranslate"><span class="pre">advanceTimeSpan()</span></code> is only called internally,
if the time stepping scheme is wrapped by another solver.
Then the wrapping class sets the values for startTime and endTime and <code class="docutils literal notranslate"><span class="pre">advanceTimeSpan()</span></code> simulates the time span <span class="math notranslate nohighlight">\([\text{startTime}, \text{endTime}]\)</span>.
In this case, it is not necessary to specify <code class="docutils literal notranslate"><span class="pre">endTime</span></code> in the python settings.</p>
<p>The scheme solves the equations in potentially multiple timesteps, with a time step width. The timestep width is constant within the time span, i.e. all time steps have the same width. It is determined either by <code class="docutils literal notranslate"><span class="pre">numberTimeSteps</span></code> or by <code class="docutils literal notranslate"><span class="pre">timeStepWidth</span></code>.
Only one of the two options needs to be specified. If both are given, <code class="docutils literal notranslate"><span class="pre">numberTimeSteps</span></code> has precedence if it is nonzero.</p>
<p>In the case of <code class="docutils literal notranslate"><span class="pre">numberTimeSteps</span></code>, the time step width is computed as the time span divided by the number of time steps.
If <code class="docutils literal notranslate"><span class="pre">timeStepWidth</span></code> is specified directly, this determines the time step width.</p>
<p>In the case of <code class="docutils literal notranslate"><span class="pre">timestepWidth</span></code>, the specified time step width will be modified to produce equally large time steps in the whole time span,
such that there are no small ‚Äúremainder‚Äù time steps at the end of the time span.</p>
<p>The rule is that the time step width will be increased by maximum 10% or decreased otherwise.
Increasing time step width is potentially dangerous, because it can make the timestepping scheme unstable.
But ideally, changing the timestep width should not be possible at all, if it is given correctly in the settings.</p>
<p>Examples:</p>
<ul class="simple">
<li><p>endTime = 1.09, timeStepWidth = 1.0 -&gt; increase dt to 1.09, one timestep</p></li>
<li><p>endTime = 1.11, timeStepWidth = 1.0 -&gt; decrease dt to 0.555, two timesteps</p></li>
</ul>
</section>
<section id="logtimestepwidthaskey-lognumbertimestepsaskey-and-durationlogkey">
<h3>logTimeStepWidthAsKey, logNumberTimeStepsAsKey and durationLogKey<a class="headerlink" href="#logtimestepwidthaskey-lognumbertimestepsaskey-and-durationlogkey" title="Link to this heading">ÔÉÅ</a></h3>
<p>These options are optional.
If they are set, information will be stored and written to the log file  <code class="docutils literal notranslate"><span class="pre">logs/log.csv</span></code> at the end of the execution, under the specified key.
This log file contains one line per run of the program, i.e. at the end of execution, one line will be added. The file is in <code class="docutils literal notranslate"><span class="pre">csv</span></code> format, all data fields are separated by semicolons (<code class="docutils literal notranslate"><span class="pre">;</span></code>).
There will be a header that specifies the names of the logged variables (so called keys).</p>
<p>If <code class="docutils literal notranslate"><span class="pre">logTimeStepWidthAsKey</span></code> is set, the time step width of this scheme will be stored under the name, that is given by <code class="docutils literal notranslate"><span class="pre">logTimeStepWidthAsKey</span></code>.
If <code class="docutils literal notranslate"><span class="pre">logNumberTimeStepsAsKey</span></code> is set, the number of time steps of this scheme will be stored under the name, that is given by <code class="docutils literal notranslate"><span class="pre">logNumberTimeStepsAsKey</span></code>.
This is useful to distinguish multiple runs with different time step widths.</p>
<p>If <code class="docutils literal notranslate"><span class="pre">durationLogKey</span></code> is set, there will be a duration measurement of the walltime for the timestepping scheme. The duration is measured by the <code class="docutils literal notranslate"><span class="pre">MPI_Wtime</span></code> call,
and is therefore the total time that has passed for the computation. This duration will be logged under the name given by <code class="docutils literal notranslate"><span class="pre">durationLogKey</span></code>.</p>
<p>If <code class="docutils literal notranslate"><span class="pre">durationLogKey</span></code> is not specified, the duration measurement will not take place.</p>
</section>
<section id="timestepoutputinterval">
<h3>timeStepOutputInterval<a class="headerlink" href="#timestepoutputinterval" title="Link to this heading">ÔÉÅ</a></h3>
<p><em>Default: 100</em></p>
<p>When the simulation runs, it is useful to get some information on the console, at which point it currently is.
But, if there were output every timestep, this would slow down the simulation. In case of a nested solver structure, it may, however, be useful to output every timestep, if it takes some time to compute it.</p>
<p>The option <code class="docutils literal notranslate"><span class="pre">timeStepOutputInterval</span></code> is a positive integer value that specifies the interval in which timesteps are printed to standard output.</p>
</section>
<section id="initialvalues">
<h3>initialValues<a class="headerlink" href="#initialvalues" title="Link to this heading">ÔÉÅ</a></h3>
<p>A list of double values to use as initial values. The solution is set to these values upon initialization.</p>
</section>
<section id="dirichletboundaryconditions-and-inputmeshisglobal">
<h3>dirichletBoundaryConditions and inputMeshIsGlobal<a class="headerlink" href="#dirichletboundaryconditions-and-inputmeshisglobal" title="Link to this heading">ÔÉÅ</a></h3>
<p>The Dirichlet-type boundary conditions that hold for the complete time span.
This is a dictionary with degrees of freedom as key and the value as value (i.e. <code class="docutils literal notranslate"><span class="pre">{&quot;dof&quot;:</span> <span class="pre">value,</span> <span class="pre">...}</span></code>.
Negative values count from the end of possible degrees of freedom, i.e. -1 means the last degree of freedom, -2 the second last and so on.</p>
<p>The degrees of freedom are interpreted in global numbering, if <code class="docutils literal notranslate"><span class="pre">inputMeshIsGlobal</span></code> is set to <code class="docutils literal notranslate"><span class="pre">True</span></code>, or in local numbering of the process, if <code class="docutils literal notranslate"><span class="pre">inputMeshIsGlobal</span></code> is <code class="docutils literal notranslate"><span class="pre">False</span></code>.</p>
</section>
<section id="outputwriter">
<h3>OutputWriter<a class="headerlink" href="#outputwriter" title="Link to this heading">ÔÉÅ</a></h3>
<p>The output writers for this time stepping scheme, see <a class="reference internal" href="output_writer.html"><span class="doc">OutputWriter</span></a>.</p>
</section>
<section id="nadditionalfieldvariables">
<h3>nAdditionalFieldVariables<a class="headerlink" href="#nadditionalfieldvariables" title="Link to this heading">ÔÉÅ</a></h3>
<p>(integer) A number of additional field variables that will be created. The purpose is to allow to write additional values with the output writers of this timestepping scheme.
The additional field variables can be set by connecting them via their connector slot. Their values will also be written by the output writers.</p>
</section>
<section id="additionalslotnames">
<h3>additionalSlotNames<a class="headerlink" href="#additionalslotnames" title="Link to this heading">ÔÉÅ</a></h3>
<p>A list of strings, names for of connector slots for the additional field variables. Each name should be smaller or equal than 10 characters.
In general, named slots are used to connect the slots from a global setting ‚ÄúconnectedSlots‚Äù. See <a class="reference internal" href="output_connector_slots.html"><span class="doc">Connector Slots</span></a> for details.</p>
</section>
</section>
<section id="expliciteuler">
<h2>ExplicitEuler<a class="headerlink" href="#expliciteuler" title="Link to this heading">ÔÉÅ</a></h2>
<p>The explicit Euler or <em>forward integration</em> is a 1st order consistent scheme for integration of ordinary differential equations.
The keyword for the settings is <code class="docutils literal notranslate"><span class="pre">&quot;ExplicitEuler&quot;</span></code>. It only uses the common properties.</p>
</section>
<section id="impliciteuler">
<h2>ImplicitEuler<a class="headerlink" href="#impliciteuler" title="Link to this heading">ÔÉÅ</a></h2>
<p>The implicit Euler or <em>backward integration</em> is a 1st order consistent implicit scheme for integration of ordinary differential equations.
The keyword for the settings is <code class="docutils literal notranslate"><span class="pre">&quot;ImplicitEuler&quot;</span></code>.
In addition to the common properties, is has the options:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="s2">&quot;solverName&quot;</span> <span class="p">:</span> <span class="s2">&quot;solver&quot;</span><span class="p">,</span>
<span class="s2">&quot;timeStepWidthRelativeTolerance&quot;</span> <span class="p">:</span> <span class="mf">1e-10</span><span class="p">,</span>
<span class="s2">&quot;timeStepWidthRelativeToleranceAsKey&quot;</span> <span class="p">:</span> <span class="s2">&quot;some_key&quot;</span><span class="p">,</span>
<span class="s2">&quot;durationInitTimeStepLogKey&quot;</span><span class="p">:</span> <span class="s2">&quot;duration_init_1D&quot;</span><span class="p">,</span>
</pre></div>
</div>
<p><code class="docutils literal notranslate"><span class="pre">solverName</span></code> is the name of the <a class="reference internal" href="solver.html"><span class="doc">Solver</span></a> to use for the linear system of equations that results from the implicit scheme.
Alternatively, the solver options can be specified directly under ‚ÄúImplicitEuler‚Äù, for details see the <a class="reference internal" href="solver.html"><span class="doc">Solver</span></a> page.</p>
<p>The <code class="docutils literal notranslate"><span class="pre">timeStepWidthRelativeTolerance</span></code> is the tolerance for the time step width which controls when the system matrix has to be recomputed.
This value will also stored in the log file if <code class="docutils literal notranslate"><span class="pre">timeStepWidthRelativeToleranceAsKey</span></code> is given.</p>
<p>If <code class="docutils literal notranslate"><span class="pre">durationInitTimeStepLogKey</span></code> is set, there will be a duration measurement of the walltime for the time step initialization.
This includes both, the initial setup and potential re-initializations if the time step size changed.</p>
</section>
<section id="heun">
<h2>Heun<a class="headerlink" href="#heun" title="Link to this heading">ÔÉÅ</a></h2>
<p>Heun integration is a 2st order consistent scheme. The keyword for the settings is <code class="docutils literal notranslate"><span class="pre">&quot;Heun&quot;</span></code>.</p>
</section>
<section id="heunadaptive">
<h2>HeunAdaptive<a class="headerlink" href="#heunadaptive" title="Link to this heading">ÔÉÅ</a></h2>
<p>The HeunAdaptive class also implements the Heun method but with a time-adaptive step width. It was implemented 2019 in the Bachelor thesis by Sebastian Kreuder.</p>
<p>The solution is computed with different time step widths, the error is estimated and compared to a tolerance.
If the estimated error is too high, the time step width gets dynamically reduced, down to a lower bound (<code class="docutils literal notranslate"><span class="pre">minTimeStepWidth</span></code>).</p>
<p>The keyword for the settings is <code class="docutils literal notranslate"><span class="pre">&quot;HeunAdaptive&quot;</span></code>.
In addition to the standard options, it has the following options:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="s2">&quot;tolerance&quot;</span><span class="p">:</span> <span class="mf">1e7</span><span class="p">,</span>
<span class="s2">&quot;lowestMultiplier&quot;</span><span class="p">:</span> <span class="mi">1000</span><span class="p">,</span>
<span class="s2">&quot;minTimeStepWidth&quot;</span><span class="p">:</span> <span class="mf">1e-5</span><span class="p">,</span>
<span class="s2">&quot;timeStepAdaptOption&quot;</span><span class="p">:</span> <span class="s2">&quot;regular&quot;</span><span class="p">,</span>
</pre></div>
</div>
<section id="tolerance">
<h3>tolerance<a class="headerlink" href="#tolerance" title="Link to this heading">ÔÉÅ</a></h3>
<p><em>Default: 0.1</em>
The tolerance for the estimated error. It is guaranteed, that the error is always smaller than this value.</p>
</section>
<section id="mintimestepwidth">
<h3>minTimeStepWidth<a class="headerlink" href="#mintimestepwidth" title="Link to this heading">ÔÉÅ</a></h3>
<p><em>Default: 1e-6</em></p>
<p>The minimum timestepwidth to use. The timestep witdh will not be decreased below this value, even if the estimated error is still above the tolerance.
This avoids starving of the computation and allows to step over very badly conditioned parts of the solution process.</p>
</section>
<section id="timestepadaptoption">
<h3>timeStepAdaptOption<a class="headerlink" href="#timestepadaptoption" title="Link to this heading">ÔÉÅ</a></h3>
<p><em>Default: regular</em></p>
<p>Method for the adaptive time step width computation.
Possible values are <code class="docutils literal notranslate"><span class="pre">&quot;regular&quot;</span></code> and <code class="docutils literal notranslate"><span class="pre">&quot;modified&quot;</span></code>. The regular method is to compute the new timestep width, <span class="math notranslate nohighlight">\(dt_\text{new}\)</span>, by</p>
<div class="math notranslate nohighlight">
\[ \begin{align}\begin{aligned}\alpha = \left(\dfrac{\text{tolerance}}{\text{estimator}}\right)^{1/3}\\dt_\text{new} = 0.9 \cdot \alpha \cdot dt_\text{old}\end{aligned}\end{align} \]</div>
<p>Care is taken to not produce too small remainder timesteps (&lt; 0.1*dt) at the end of the time span.</p>
<p>The modified version only allows equally sized time step widths for the total time span. The time step width is fixed at the beginning of the time span. This is only usefull in the inner timestepping of a splitting scheme.
For details on the effects see the Bachelor thesis document.</p>
</section>
<section id="lowestmultiplier">
<h3>lowestMultiplier<a class="headerlink" href="#lowestmultiplier" title="Link to this heading">ÔÉÅ</a></h3>
<p><em>Default: 1000</em>
This is the minimum number of timesteps to perform in the time span for the ‚Äúmodified‚Äù method. E.g. by default there will be at least 1000 time steps in the time span.</p>
</section>
</section>
<section id="cranknicolson">
<h2>CrankNicolson<a class="headerlink" href="#cranknicolson" title="Link to this heading">ÔÉÅ</a></h2>
<p>The Crank Nicolson scheme is implicit and 2nd order consistent.
The keyword for the settings is <code class="docutils literal notranslate"><span class="pre">&quot;CrankNicolson&quot;</span></code>.
In addition to the common properties, it has the options:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="s2">&quot;solverName&quot;</span> <span class="p">:</span> <span class="s2">&quot;solver&quot;</span>
<span class="s2">&quot;timeStepWidthRelativeTolerance&quot;</span> <span class="p">:</span> <span class="mf">1e-10</span><span class="p">,</span>
<span class="s2">&quot;timeStepWidthRelativeToleranceAsKey&quot;</span> <span class="p">:</span> <span class="s2">&quot;some_key&quot;</span><span class="p">,</span>
<span class="s2">&quot;durationInitTimeStepLogKey&quot;</span><span class="p">:</span> <span class="s2">&quot;duration_init_1D&quot;</span><span class="p">,</span>
</pre></div>
</div>
<p><code class="docutils literal notranslate"><span class="pre">solverName</span></code> is the name of the <a class="reference internal" href="solver.html"><span class="doc">Solver</span></a> to use for the linear system of equations that results from the implicit scheme.
Alternatively, the solver options can be specified directly under ‚ÄúCrankNicolson‚Äù, for details see the <a class="reference internal" href="solver.html"><span class="doc">Solver</span></a> page.</p>
<p>The <code class="docutils literal notranslate"><span class="pre">timeStepWidthRelativeTolerance</span></code> is the tolerance for the time step width which controls when the system matrix has to be recomputed.
This value will also stored in the log file if <code class="docutils literal notranslate"><span class="pre">timeStepWidthRelativeToleranceAsKey</span></code> is given.</p>
<p>If <code class="docutils literal notranslate"><span class="pre">durationInitTimeStepLogKey</span></code> is set, there will be a duration measurement of the walltime for the time step initialization.
This includes both, the initial setup and potential re-initializations if the time step size changed.</p>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="finite_element_method.html" class="btn btn-neutral float-left" title="FiniteElementMethod" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="splitting.html" class="btn btn-neutral float-right" title="Operator Splitting" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2020, Benjamin Maier. MIT licence, see LICENSE for details..</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>